<div class="lg:px-5 lg:py-5" *ngIf="request">
    <div class="flex flex-col xl:flex-row">
        <div class="flex flex-col w-full p-6 space-y-5">
            <div class="flex items-center justify-between w-full">
                <div>
                    <div class="text-3xl font-semibold tracking-tight leading-8">Trámite
                        de: {{ request.Servicio.nombre }}</div>
                    <div class="font-medium tracking-tight text-slate-500">
                        Se creo el: <b>{{ request.fecha_alta | date: 'longDate' }}</b>
                    </div>
                    <div class="font-medium tracking-tight text-slate-500">
                        Estatus de la solicitud:
                        <ng-container *ngFor="let status of statuses">
                            <span *ngIf="status.value === request.estatus_solicitud_id"
                                  class="inline-flex items-center font-bold px-2.5 py-0.5 rounded-full tracking-wide uppercase {{ status.styles }}">
                                <span class="whitespace-nowrap text-xs">{{status.name}}</span>
                            </span>
                        </ng-container>
                    </div>
                    <div class="font-medium tracking-tight text-slate-500" *ngIf="request.servicio_id === 7">
                        Número de Licencia de Funcionamiento:
                        <b>{{ request.LicenciaFuncionamiento.licencia_funcionamiento_id }}</b>
                    </div>
                </div>
            </div>

            <mat-tab-group animationDuration="0ms">
                <mat-tab>
                    <ng-template mat-tab-label>
                        <i class="fa-solid fa-folder-open"></i>&nbsp;Información y Requisitos
                    </ng-template>
                    <div class="overflow-hidden bg-white mt-10 rounded-2xl border">

                        <ol class="px-4 py-5 sm:px-6 items-center w-full space-y-4 sm:flex sm:space-x-8 sm:space-y-0">
                            <li class="flex items-center space-x-2.5"
                                [ngClass]="request.estatus_solicitud_id === 1 || request.estatus_solicitud_id === 2 || request.estatus_solicitud_id === 5 ? 'text-blue-600' : 'text-gray-300'">
                                <span>
                                    <p class="text-sm">Adjuntar requisitos</p>
                                </span>
                            </li>
                            <li class="flex items-center space-x-2.5"
                                *ngIf="[14, 15, 21, 22, 2].includes(request.servicio_id)"
                                [ngClass]="request.estatus_solicitud_id === 24 ? 'text-blue-600' : 'text-gray-300'">
                                <span>
                                    <p class="text-sm">Documentación complementaria</p>
                                </span>
                            </li>

                            <li class="flex items-center space-x-2.5" *ngIf="[8].includes(request.servicio_id)"
                                [ngClass]="request.estatus_solicitud_id === 36  ? 'text-blue-600' : 'text-gray-300'">
                                <span>
                                    <p class="text-sm">Visita de inspección fisica</p>
                                </span>
                            </li>
                            <li class="flex items-center space-x-2.5"
                                [ngClass]="request.estatus_solicitud_id === 10 || request.estatus_solicitud_id === 20 || request.estatus_solicitud_id === 21 ? 'text-blue-600' : 'text-gray-300'">
                                <span>
                                    <p class="text-sm">Validación de pago</p>
                                </span>
                            </li>

                            <li class="flex items-center space-x-2.5" *ngIf="[11].includes(request.servicio_id)"
                                [ngClass]="request.estatus_solicitud_id === 27 || request.estatus_solicitud_id === 28 || request.estatus_solicitud_id === 29  ? 'text-blue-600' : 'text-gray-300'">
                                <span>
                                    <p class="text-sm">Visita Topográfica</p>
                                </span>
                            </li>

                            <li class="flex items-center space-x-2.5" *ngIf="[2].includes(request.servicio_id)"
                                [ngClass]="request.estatus_solicitud_id === 31 ? 'text-blue-600' : 'text-gray-300'">
                                <span>
                                    <p class="text-sm">Visita para valuación</p>
                                </span>
                            </li>

                            <li class="flex items-center space-x-2.5"
                                *ngIf="request.servicio_id === 6 || request.servicio_id === 7"
                                [ngClass]="request.estatus_solicitud_id === 22 ? 'text-blue-600' : 'text-gray-300'">
                                <span>
                                    <p class="text-sm">Anuencia de protección civil</p>
                                </span>
                            </li>

                            <li class="flex items-center space-x-2.5"
                                *ngIf="request.servicio_id === 6"
                                [ngClass]="request.estatus_solicitud_id === 38 ? 'text-blue-600' : 'text-gray-300'">
                                <span>
                                    <p class="text-sm">Uso de suelo de giro comercial</p>
                                </span>
                            </li>

                            <li class="flex items-center text-gray-300 space-x-2.5" *ngIf="request.servicio_id !== 13">
                                <span>
                                    <p class="text-sm">Descargar archivo</p>
                                </span>
                            </li>
                        </ol>


                        <!-- Adjuntar requisitos -->
                        <ng-container
                            *ngIf="request.estatus_solicitud_id === 1 || request.estatus_solicitud_id === 2 || request.estatus_solicitud_id === 5">
                            <div class="border-t border-gray-200">
                                <div class="w-full mx-auto block p-10 text-center space-y-3" *ngIf="request.servicio_id === 10">
                                    <i class="fa-solid fa-arrow-up-right-from-square fa-5x text-slate-500"></i>
                                    <div>
                                        <p class="font-medium text-lg">Tu trámite esta en proceso</p>
                                        <p>Visita <a href="{{request.ExpedientePao.url_consulta}}" target="_blank" class="text-blue-600">el siguiente link</a> para ver el estatus </p>
                                    </div>
                                </div>
                                <dl class="pb-5 text-gray-900" *ngIf="request.servicio_id !== 10">
                                    <div class="border-b flex flex-col px-5 py-5"
                                         *ngFor="let requeriment of requeriments">

                                        <dt class="mb-1 text-md">
                                            <span
                                                class="text-red-800 text-xs"
                                                *ngIf="requeriment.obligatorio === 1">
                                                <i class="fa-solid fa-star-of-life fa-xs"></i>
                                                Requerido
                                            </span>
                                            <p>
                                                {{ requeriment.Requisito.nombre }}
                                            </p>
                                        </dt>
                                        <dd class="flex items-center justify-between font-medium text-gray-500">
                                            <div class="flex space-x-2">
                                                <!-- Subir documentos por primera vez -->
                                                <button mat-flat-button color="primary"
                                                        (click)="selectDocument(requeriment.Requisito.id)"
                                                        class="px-3 py-2 text-xs font-medium rounded-md"
                                                        *ngIf="!requeriment.Requisito.Documento">
                                                    Examinar archivos
                                                </button>
                                                <!-- Boton para eliminar el documento actual y actualizarlo. No se ha enviado la solicitud antes. -->
                                                <ng-container
                                                    *ngIf="requestId !== requeriment.Requisito.id && request.estatus_solicitud_id !== 2">
                                                    <button mat-stroked-button color="warn"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            (click)="reUploadDocument(requeriment.Requisito.Documento.id)"
                                                            *ngIf="requeriment.Requisito.Documento && requeriment.Requisito.Documento.estatus === 0 && request.estatus_solicitud_id !== 12">
                                                        Eliminar y subir nuevamente
                                                    </button>
                                                </ng-container>
                                                <!-- Adjuntar nuevamente el documento cuando se elimino. No se ha envado la solicitud
                                                <button mat-stroked-button color="primary"
                                                        (click)="reSelectDocumentToUpdate(requeriment.Requisito.id, requeriment.Requisito.Documento.id)"
                                                        class="px-3 py-2 text-xs font-medium rounded-md"
                                                        *ngIf="reUpload && requestId === requeriment.Requisito.id">
                                                    Adjuntar nuevamente
                                                </button>-->
                                                <!-- Adjuntar nuevamente el documento cuando ya se ha rechazado por el admin -->
                                                <button mat-flat-button color="primary"
                                                        class="px-3 py-2 text-xs font-medium rounded-md"
                                                        (click)="reSelectDocumentToUpdate(requeriment.Requisito.id, requeriment.Requisito.Documento.id)"
                                                        *ngIf="requeriment.Requisito.Documento && (requeriment.Requisito.Documento.estatus === -1)">
                                                    Adjuntar nuevamente
                                                </button>
                                                <!-- Ver documento adjunto por contribuyente -->
                                                <button mat-stroked-button color="primary"
                                                        class="px-3 py-2 text-xs font-medium rounded-md"
                                                        (click)="openDocument(requeriment.Requisito.Documento.Documentacion)"
                                                        *ngIf="requeriment.Requisito.Documento && requeriment.Requisito.Documento.estatus !== -2">
                                                    Ver adjunto
                                                </button>
                                            </div>
                                            <!-- Estatus en el que se encuentra el documento adjunto -->
                                            <div class="space-x-2">
                                            <span
                                                class="bg-gray-200 text-gray-600 text-xs font-medium px-2.5 py-0.5 rounded"
                                                *ngIf="requeriment.Requisito.Documento && requeriment.Requisito.Documento.estatus === 0">
                                                  <i class="fa-solid fa-clock fa-sm"></i>
                                                Enviado
                                            </span>
                                                <span
                                                    class="bg-green-200 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded"
                                                    *ngIf="requeriment.Requisito.Documento && requeriment.Requisito.Documento.estatus === 1">
                                                <i class="fa-solid fa-circle-check"></i>
                                                Aceptado
                                            </span>
                                                <span
                                                    class="bg-gray-200 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded"
                                                    *ngIf="requeriment.Requisito.Documento && requeriment.Requisito.Documento.estatus === -1">
                                                        <i class="fa-solid fa-circle-xmark"></i>
                                                    Rechazado
                                                </span>

                                            </div>
                                        </dd>
                                    </div>
                                </dl>
                            </div>

                            <form [formGroup]="solicitudForm" class="p-4"
                                  *ngIf="request.estatus_solicitud_id === 1 || request.estatus_solicitud_id === 5">
                                <mat-form-field appearance="outline" class="w-full text-xs">
                                    <mat-label>Escribe un comentario</mat-label>
                                    <textarea matInput formControlName="comentario" rows="4"></textarea>
                                </mat-form-field>

                                <div class="space-x-3">
                                    <button mat-stroked-button color="primary" (click)="saveRequest('1')"
                                            class="rounded-md"
                                            *ngIf="request.estatus_solicitud_id === 1">
                                        <mat-spinner class="inline w-4 h-4 mr-7" diameter="20" color="accent"
                                                     *ngIf="saving"></mat-spinner>
                                        Guardar y enviar despues
                                    </button>

                                    <button mat-flat-button (click)="saveRequest('2')" class="rounded-md"
                                            color="primary"
                                            *ngIf="request.estatus_solicitud_id !== 12"
                                            [disabled]="reqWithDocuments.length === 0 || reqMandatory.length !== reqWithDocuments.length">
                                        Finalizar y enviar
                                    </button>
                                </div>
                            </form>
                        </ng-container>

                        <!-- Validación de pago -->
                        <ng-container
                            *ngIf="request.estatus_solicitud_id === 10 || request.estatus_solicitud_id === 21">
                            <div class="border-t border-gray-200">
                                <div *ngIf="request.estatus_solicitud_id === 21"
                                     class="flex p-4 mb-4 text-sm text-yellow-800 border border-yellow-300 bg-yellow-50">
                                    <i class="fa-solid fa-circle-info fa-lg mr-3"></i>
                                    <div>
                                        Es probable que alguno de los documentos haya sido rechazado. Revisa y adjunta
                                        nuevamente el archivo.
                                    </div>
                                </div>
                                <dl class="pb-5 text-gray-900">
                                    <ng-container *ngFor="let doc of paymentDocs">
                                        <div class="border-b flex flex-col px-5 py-5">
                                            <dt class="mb-1 text-md">
                                                {{ doc.name }}
                                            </dt>
                                            <dd class="flex items-center justify-between font-medium text-gray-500">
                                                <div class="flex space-x-2">
                                                    <!-- Subir documentos por primera vez -->
                                                    <button mat-flat-button color="primary" *ngIf="!doc.doc"
                                                            (click)="selectPaymentDocument(doc.id)"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Examinar archivos
                                                    </button>
                                                    <button mat-flat-button color="primary"
                                                            *ngIf="doc.doc && (doc.doc['status'] === -1)"
                                                            (click)="reSelectPaymentDocumentToUpdate(doc.id, doc.doc['id'])"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Adjuntar nuevamente
                                                    </button>
                                                    <button mat-stroked-button color="warn"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            (click)="reUploadDocumentoPago(doc.doc['id'])"
                                                            *ngIf="doc.doc && doc.doc['status'] === 0">
                                                        Eliminar y subir nuevamente
                                                    </button>

                                                    <!-- Ver documento adjunto por contribuyente -->
                                                    <button mat-stroked-button color="primary"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            *ngIf="doc.doc"
                                                            (click)="openPaymentDocument(doc.doc['documentacion_id'])">
                                                        Ver adjunto
                                                    </button>
                                                    <!-- Ver documento adjunto por contribuyente -->
                                                    <!--<button mat-stroked-button color="primary"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            *ngIf="doc.doc">
                                                        Ver adjunto
                                                    </button>-->
                                                </div>
                                                <div class="space-x-2">
                                                    <span *ngIf="doc.doc && doc.doc['status'] === 0"
                                                          class="bg-gray-200 text-gray-600 text-xs font-medium px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-clock fa-sm"></i>
                                                        Enviado
                                                    </span>
                                                    <span *ngIf="doc.doc && doc.doc['status'] === 1"
                                                          class="bg-green-200 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-circle-check"></i>
                                                        Aceptado
                                                    </span>
                                                    <span
                                                        class="bg-gray-200 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded"
                                                        *ngIf="doc.doc && doc.doc['status'] === -1">
                                                            <i class="fa-solid fa-circle-xmark"></i>
                                                        Rechazado
                                                    </span>
                                                </div>
                                            </dd>
                                        </div>

                                    </ng-container>

                                </dl>
                            </div>

                            <div class="px-4 pb-4 text-right"
                                 *ngIf="(request.estatus_solicitud_id === 10 || request.estatus_solicitud_id === 21) && request.DocumentosPago.length === paymentDocs.length">
                                <button mat-flat-button (click)="validatePayment('20')" class="rounded-md"
                                        color="success">
                                    Validar pago
                                </button>
                            </div>
                        </ng-container>

                        <!-- Anuencia Protección Civil -->
                        <ng-container
                            *ngIf="request.estatus_solicitud_id === 22 && (request.servicio_id === 7 || request.servicio_id === 6)">
                            <div class="p-10 space-y-8">
                                <button mat-flat-button (click)="redirectToService()" color="primary">
                                    Iniciar trámite
                                </button>

                                <p class="text-sm text-slate-500 text-center w-1/4 border-b-2 leading-3"><span
                                    class="bg-white px-3">O adjunta los documentos</span></p>

                                <dl class="pb-5 text-gray-900">
                                    <ng-container *ngFor="let doc of anuenciaDocs">
                                        <div class="border-b flex flex-col px-5 py-5">
                                            <dt class="mb-1 text-md">
                                                {{ doc.name }}
                                            </dt>
                                            <dd class="flex items-center justify-between font-medium text-gray-500">
                                                <div class="flex space-x-2">
                                                    <!-- Subir documentos por primera vez -->
                                                    <button mat-flat-button color="primary" *ngIf="!doc.doc"
                                                            (click)="selectAnuenciaDocument(doc.id)"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Examinar archivos
                                                    </button>
                                                    <button mat-flat-button color="primary"
                                                            *ngIf="doc.doc && (doc.doc['status'] === -1)"
                                                            (click)="reSelectAnuenciaDocumentToUpdate(doc.id, doc.doc['id'])"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Adjuntar nuevamente
                                                    </button>

                                                    <button mat-stroked-button color="warn"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            (click)="reUploadDocumentoAnuencia(doc.doc['id'])"
                                                            *ngIf="doc.doc && doc.doc['status'] === 0">
                                                        Eliminar y subir nuevamente
                                                    </button>

                                                    <!--<button mat-stroked-button color="primary"
                                                            *ngIf="doc.doc && (doc.doc['status'] === -1)"
                                                            (click)="reSelectAnuenciaDocumentToUpdate(doc.id, doc.doc['id'])"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Adjuntar nuevamente
                                                    </button>-->

                                                    <!-- Ver documento adjunto por contribuyente -->
                                                    <button mat-stroked-button color="primary"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            *ngIf="doc.doc"
                                                            (click)="openAnuenciaDocument(doc.doc['documentacion_id'])">
                                                        Ver adjunto
                                                    </button>
                                                    <!-- Ver documento adjunto por contribuyente -->
                                                    <!--<button mat-stroked-button color="primary"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            *ngIf="doc.doc">
                                                        Ver adjunto
                                                    </button>-->
                                                </div>
                                                <div class="space-x-2">
                                                    <span *ngIf="doc.doc && doc.doc['status'] === 0"
                                                          class="bg-gray-200 text-gray-600 text-xs font-medium px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-clock fa-sm"></i>
                                                        Enviado
                                                    </span>
                                                    <span *ngIf="doc.doc && doc.doc['status'] === 1"
                                                          class="bg-green-200 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-circle-check"></i>
                                                        Aceptado
                                                    </span>
                                                    <span
                                                        class="bg-gray-200 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded"
                                                        *ngIf="doc.doc && doc.doc['status'] === -1">
                                                            <i class="fa-solid fa-circle-xmark"></i>
                                                        Rechazado
                                                    </span>
                                                </div>
                                            </dd>
                                        </div>

                                    </ng-container>
                                </dl>
                            </div>
                            <div class="px-4 pb-4 text-right"
                                 *ngIf="(request.estatus_solicitud_id === 10 || request.estatus_solicitud_id === 21 || request.estatus_solicitud_id === 22) && request.DocumentosAnuencia.length === anuenciaDocs.length">
                                <button mat-flat-button (click)="changeStatus('23')" class="rounded-md"
                                        color="success">
                                    Validar anuencia
                                </button>
                            </div>
                        </ng-container>

                        <!-- Uso de Suelo de Giro Comercial -->
                        <ng-container *ngIf="request.estatus_solicitud_id === 38 && (request.servicio_id === 6)">
                            <div class="p-10 space-y-8">
                                <button mat-flat-button (click)="redirectToGiroComercial()" color="primary">
                                    Iniciar trámite
                                </button>

                                <p class="text-sm text-slate-500 text-center w-1/4 border-b-2 leading-3"><span
                                    class="bg-white px-3">O adjunta los documentos</span></p>

                                <dl class="pb-5 text-gray-900">
                                    <ng-container *ngFor="let doc of giroComercial">
                                        <div class="border-b flex flex-col px-5 py-5">
                                            <dt class="mb-1 text-md">
                                                {{ doc.name }}
                                            </dt>
                                            <dd class="flex items-center justify-between font-medium text-gray-500">
                                                <div class="flex space-x-2">
                                                    <!-- Subir documentos por primera vez -->
                                                    <button mat-flat-button color="primary" *ngIf="!doc.doc"
                                                            (click)="selectGiroDocument(doc.id)"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Examinar archivos
                                                    </button>
                                                    <button mat-flat-button color="primary"
                                                            *ngIf="doc.doc && (doc.doc['status'] === -1)"
                                                            (click)="reSelectGiroDocumentToUpdate(doc.id, doc.doc['id'])"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Adjuntar nuevamente
                                                    </button>

                                                    <button mat-stroked-button color="warn"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            (click)="reUploadDocumentoGiro(doc.doc['id'])"
                                                            *ngIf="doc.doc && doc.doc['status'] === 0">
                                                        Eliminar y subir nuevamente
                                                    </button>

                                                    <!-- Ver documento adjunto por contribuyente -->
                                                    <button mat-stroked-button color="primary"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            *ngIf="doc.doc"
                                                            (click)="openAnuenciaDocument(doc.doc['documentacion_id'])">
                                                        Ver adjunto
                                                    </button>
                                                </div>
                                                <div class="space-x-2">
                                                    <span *ngIf="doc.doc && doc.doc['status'] === 0"
                                                          class="bg-gray-200 text-gray-600 text-xs font-medium px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-clock fa-sm"></i>
                                                        Enviado
                                                    </span>
                                                    <span *ngIf="doc.doc && doc.doc['status'] === 1"
                                                          class="bg-green-200 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-circle-check"></i>
                                                        Aceptado
                                                    </span>
                                                    <span
                                                        class="bg-gray-200 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded"
                                                        *ngIf="doc.doc && doc.doc['status'] === -1">
                                                            <i class="fa-solid fa-circle-xmark"></i>
                                                        Rechazado
                                                    </span>
                                                </div>
                                            </dd>
                                        </div>

                                    </ng-container>
                                </dl>
                            </div>
                            <div class="px-4 pb-4 text-right"
                                 *ngIf="(request.estatus_solicitud_id === 10 || request.estatus_solicitud_id === 21 || request.estatus_solicitud_id === 22 || request.estatus_solicitud_id === 38) && request.DocumentosLicenciaComercial.length === giroComercial.length">
                                <button mat-flat-button (click)="changeStatus('39')" class="rounded-md"
                                        color="success">
                                    Validar anuencia
                                </button>
                            </div>
                        </ng-container>

                        <!-- Documentación complementaria -->
                        <ng-container
                            *ngIf="request.estatus_solicitud_id === 24">
                            <div class="border-t border-gray-200">
                                <dl class="pb-5 text-gray-900">
                                    <ng-container>
                                        <div class="border-b flex flex-col px-5 py-5">
                                            <dt class="mb-1 text-md">
                                                Documentación complementaria
                                            </dt>
                                            <dd class="flex items-center justify-between font-medium text-gray-500">
                                                <div class="flex space-x-2">
                                                    <!-- Subir documentos por primera vez -->
                                                    <button mat-flat-button color="primary"
                                                            *ngIf="!request.DocumentosComplementarios"
                                                            (click)="selectComplementaryDocument()"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Examinar archivos
                                                    </button>
                                                    <button mat-flat-button color="primary"
                                                            (click)="reSelectComplementaryDocumentToUpdate(request.DocumentosComplementarios.id)"
                                                            *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === -1"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Adjuntar nuevamente
                                                    </button>
                                                    <button mat-stroked-button color="warn"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            (click)="reUploadDocumentoComplementario(request.DocumentosComplementarios.id)"
                                                            *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === 0">
                                                        Eliminar y subir nuevamente
                                                    </button>

                                                    <!-- Ver documento adjunto por contribuyente -->
                                                    <button mat-stroked-button color="primary"
                                                            (click)="openDocumentComplementary(request.DocumentosComplementarios.documentacion_id)"
                                                            *ngIf="request.DocumentosComplementarios"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Ver adjunto
                                                    </button>
                                                </div>
                                                <div class="space-x-2">
                                                    <span
                                                        *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === 0"
                                                        class="bg-gray-200 text-gray-600 text-xs font-medium px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-clock fa-sm"></i>
                                                        Enviado
                                                    </span>
                                                    <span
                                                        *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === 1"
                                                        class="bg-green-200 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-circle-check"></i>
                                                        Aceptado
                                                    </span>
                                                    <span
                                                        class="bg-gray-200 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded"
                                                        *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === -1">
                                                            <i class="fa-solid fa-circle-xmark"></i>
                                                        Rechazado
                                                    </span>
                                                </div>
                                            </dd>
                                        </div>

                                    </ng-container>

                                </dl>
                            </div>

                            <div class="px-4 pb-4 text-right">
                                <button
                                    *ngIf="(request.estatus_solicitud_id === 24) && request.DocumentosComplementarios"
                                    mat-flat-button (click)="validateComplementaryDocument('25')" class="rounded-md"
                                    color="success">
                                    Enviar a validación
                                </button>
                            </div>
                        </ng-container>

                        <!-- Evidencia de puntos de distinción -->
                        <ng-container
                            *ngIf="request.estatus_solicitud_id === 29">
                            <div class="border-t border-gray-200">
                                <dl class="pb-5 text-gray-900">
                                    <ng-container>
                                        <div class="border-b flex flex-col px-5 py-5">
                                            <dt class="mb-1 text-md">
                                                Evidencia de Puntos de Distinción
                                            </dt>
                                            <dd class="flex items-center justify-between font-medium text-gray-500">
                                                <div class="flex space-x-2">
                                                    <!-- Subir documentos por primera vez -->
                                                    <button mat-flat-button color="primary"
                                                            *ngIf="!request.DocumentosComplementarios"
                                                            (click)="selectComplementaryDocument()"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Examinar archivos
                                                    </button>
                                                    <button mat-flat-button color="primary"
                                                            (click)="reSelectComplementaryDocumentToUpdate(request.DocumentosComplementarios.id)"
                                                            *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === -1"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Adjuntar nuevamente
                                                    </button>
                                                    <button mat-stroked-button color="warn"
                                                            class="px-3 py-2 text-xs font-medium rounded-md"
                                                            (click)="reUploadDocumentoComplementario(request.DocumentosComplementarios.id)"
                                                            *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === 0">
                                                        Eliminar y subir nuevamente
                                                    </button>

                                                    <!-- Ver documento adjunto por contribuyente -->
                                                    <button mat-stroked-button color="primary"
                                                            (click)="openDocumentComplementary(request.DocumentosComplementarios.documentacion_id)"
                                                            *ngIf="request.DocumentosComplementarios"
                                                            class="px-3 py-2 text-xs font-medium rounded-md">
                                                        Ver adjunto
                                                    </button>
                                                </div>
                                                <div class="space-x-2">
                                                    <span
                                                        *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === 0"
                                                        class="bg-gray-200 text-gray-600 text-xs font-medium px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-clock fa-sm"></i>
                                                        Enviado
                                                    </span>
                                                    <span
                                                        *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === 1"
                                                        class="bg-green-200 text-green-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded">
                                                        <i class="fa-solid fa-circle-check"></i>
                                                        Aceptado
                                                    </span>
                                                    <span
                                                        class="bg-gray-200 text-gray-800 text-xs font-medium mr-2 px-2.5 py-0.5 rounded"
                                                        *ngIf="request.DocumentosComplementarios && request.DocumentosComplementarios.status === -1">
                                                            <i class="fa-solid fa-circle-xmark"></i>
                                                        Rechazado
                                                    </span>
                                                </div>
                                            </dd>
                                        </div>

                                    </ng-container>

                                </dl>
                            </div>

                            <div class="px-4 pb-4 text-right">
                                <button
                                    *ngIf="(request.estatus_solicitud_id === 29) && request.DocumentosComplementarios"
                                    mat-flat-button (click)="validateComplementaryDocument('30')" class="rounded-md"
                                    color="success">
                                    Enviar a validación
                                </button>
                            </div>
                        </ng-container>

                        <!-- Descargar documento trámite -->
                        <ng-container
                            *ngIf="request.estatus_solicitud_id === 9 || request.estatus_solicitud_id === 18 && (request.servicio_id !== 13)">
                            <div class=" border-t border-gray-200">
                                <div
                                    class="flex p-4 mb-4 text-sm text-green-800 border border-green-300 bg-green-50">
                                    <i class="fa-solid fa-circle-check fa-lg mr-3"></i>
                                    <div>
                                        Tu trámite esta listo. Es importante saber que el documento digitalizado no
                                        tiene validez oficial, por lo que es necesario
                                        recoger el documento oficial en las oficinas del H. Ayuntamiento de Solidaridad
                                    </div>
                                </div>

                                <div class="grid grid-cols-5 gap-4 mt-3 p-10">
                                    <div
                                        class="relative w-full h-40 p-4 border rounded-2xl bg-white mx-auto">
                                        <a (click)="getRequestDocument(request.id)"
                                           class="z-10 absolute inset-0 flex flex-col p-4 cursor-pointer">
                                            <div class="aspect-[9/6]">
                                                <div class="flex items-center justify-center h-full text-slate-400">
                                                    <!-- Icon -->
                                                    <i class="fa-solid fa-file fa-3x"></i>
                                                </div>
                                            </div>
                                            <div class="flex flex-col flex-auto justify-center text-center text-xs">
                                                <div class="truncate font-medium">DOCUMENTO DE TRÁMITE DIGITAL</div>
                                                <div class="text-green-600 truncate font-normal">¡Descargar ahora!</div>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>

                        </ng-container>

                        <!-- Mensajes de alerta al usuario -->
                        <ng-container *ngIf="request.estatus_solicitud_id === 20">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-circle-check fa-5x text-emerald-600"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud esta en válidación de pago</p>
                                    <p>Este trámite puede tardar aproximadamente entre 3 a 5 días habiles</p>
                                    <p>Si deseas generar tu factura, puedes hacerlo <a
                                        href="https://facturacion.gobiernodesolidaridad.gob.mx/facturacontribuyente/"
                                        target="_blank" class="text-blue-600 underline">haciendo click aquí</a></p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="[11, 19, 15, 16, 17, 8, 23, 25, 39].includes(request.estatus_solicitud_id)">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <ng-container *ngFor="let status of statuses">
                                        <p class="font-medium text-lg"
                                           *ngIf="status.value === request.estatus_solicitud_id">
                                            La solicitud esta en estatus: <b>{{status.name}}</b>
                                        </p>
                                    </ng-container>

                                    <p>Favor de estar al pendiente del estatus de tu solicitud. Gracias por tu
                                        paciencia</p>
                                    <p *ngIf="request.estatus_solicitud_id === 11" class="text-blue-600">Puedes
                                        encontrar tu recibo de pago en el apartado "Mis documentos" con el número de
                                        folio de tu solicitud</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 26">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-file-invoice fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">Tu pase a caja se esta generando</p>
                                    <p>Favor de estar al pendiente del estatus de tu solicitud. Gracias por tu
                                        paciencia.</p>
                                </div>
                            </div>
                        </ng-container>

                        <!--<ng-container *ngIf="request.estatus_solicitud_id === 12">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-circle-check fa-5x text-emerald-600"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud esta en validación de requisitos</p>
                                    <p>Favor de estar al pendiente del estatus de tu solicitud. Gracias por tu
                                        paciencia..</p>
                                </div>
                            </div>
                        </ng-container>-->

                        <ng-container *ngIf="request.estatus_solicitud_id === 33">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">Se esta realizando el cambio de propietario</p>
                                    <p>Favor de estar al pendiente del estatus de tu solicitud. Gracias por tu
                                        paciencia..</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 34">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-circle-check fa-5x text-emerald-600"></i>
                                <div>
                                    <p class="font-medium text-lg">Se aplico el cambio de propietario correctamente</p>
                                    <p>Favor de estar al pendiente del estatus de tu solicitud. Gracias por tu
                                        paciencia..</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 12">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-circle-check fa-5x text-emerald-600"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud esta en validación de requisitos</p>
                                    <p>Favor de estar al pendiente del estatus de tu solicitud. Gracias por tu
                                        paciencia..</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 27 && !request.fecha_visita">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud se encuentra en espera de Visita
                                        Topográfica</p>
                                    <p>Tu fecha sera programada en los próximos días. Favor de estar al pendiente del
                                        estatus de tu solicitud.</p>
                                    <p>Gracias por tu paciencia</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 27 && request.fecha_visita">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-circle-check fa-5x text-emerald-600"></i>
                                <div>
                                    <p class="font-medium text-lg">La visita topográfica ha sido programada.</p>
                                    <p>Te estaremos visitando el día {{ request.fecha_visita | date }} en un horario de
                                        9 a 5 PM</p>
                                </div>
                            </div>
                        </ng-container>


                        <ng-container
                            *ngIf="request.estatus_solicitud_id === 28">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud esta en Visita Topográfica</p>
                                    <p>Fecha programada de la visita: <b>{{request.fecha_visita | date }}</b></p>
                                </div>
                            </div>
                        </ng-container>

                        <!-- Fecha de inspección fisica -->

                        <ng-container *ngIf="request.estatus_solicitud_id === 36 && !request.fecha_visita">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud se encuentra en espera de Inspección fisica</p>
                                    <p>Tu fecha sera programada en los próximos días. Favor de estar al pendiente del
                                        estatus de tu solicitud.</p>
                                    <p>Gracias por tu paciencia</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 36 && request.fecha_visita">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-circle-check fa-5x text-emerald-600"></i>
                                <div>
                                    <p class="font-medium text-lg">La inspección fisica ha sido programada.</p>
                                    <p>Te estaremos visitando el día {{ request.fecha_visita | date }} en un horario de
                                        9 a 5 PM</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 35">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud se encuentra en espera de Inspección fisica</p>
                                    <p>Tu fecha sera programada en los próximos días. Favor de estar al pendiente del
                                        estatus de tu solicitud.</p>
                                </div>
                            </div>
                        </ng-container>

                        <!-- visita para valuación -->

                        <ng-container *ngIf="request.estatus_solicitud_id === 31 && !request.fecha_visita">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud se encuentra en espera de Visita de valuacón </p>
                                    <p>Tu fecha sera programada en los próximos días. Favor de estar al pendiente del
                                        estatus de tu solicitud.</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 31 && request.fecha_visita">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-circle-check fa-5x text-emerald-600"></i>
                                <div>
                                    <p class="font-medium text-lg">La visita para valuación ha sido programada.</p>
                                    <p>Te estaremos visitando el día {{ request.fecha_visita | date }} en un horario de
                                        9 a 5 PM</p>
                                </div>
                            </div>
                        </ng-container>

                        <!-- en visita-->
                        <ng-container
                            *ngIf="request.estatus_solicitud_id === 32">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud esta en Visita para valuación</p>
                                    <p>Fecha programada de la visita: <b>{{request.fecha_visita | date }}</b></p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 30">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud esta en validación de puntos de
                                        distinción</p>
                                    <p>Favor de estar al pendiente del estatus de tu solicitud. Gracias por tu
                                        paciencia..</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="request.estatus_solicitud_id === 37">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-regular fa-clock fa-5x text-slate-500"></i>
                                <div>
                                    <p class="font-medium text-lg">La solicitud esta en Calificación de Expediente</p>
                                    <p>Favor de estar al pendiente del estatus de tu solicitud. Gracias por tu
                                        paciencia.</p>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container
                            *ngIf="(request.estatus_solicitud_id === 9 || request.estatus_solicitud_id === 18) && (request.servicio_id === 13)">
                            <div class="w-full mx-auto block p-10 text-center space-y-3">
                                <i class="fa-solid fa-circle-check fa-5x text-emerald-600"></i>
                                <div>
                                    <p class="font-medium text-lg">El trámite se aprobo y se finalizo con éxito</p>
                                    <p><b>¡Importante!</b> Conserva tu comprobante de pago para futuros trámites.</p>
                                </div>
                            </div>
                        </ng-container>
                    </div>
                </mat-tab>
                <mat-tab>
                    <ng-template mat-tab-label>
                        <i class="fa-solid fa-envelope"></i>&nbsp;Mensajes
                    </ng-template>
                    <div class="overflow-hidden bg-white mt-10 rounded-2xl border">
                        <div class="px-4 py-5 sm:px-6">
                            <div class="mb-5">
                                <h3 class="text-lg font-medium leading-6 text-gray-900">Mensajes al contribuyente</h3>
                                <p class="mt-1 max-w-2xl text-sm text-gray-500">Historial de mensajes enviado al
                                    contribuyente</p>
                            </div>
                            <div class="flex flex-col text-center p-6 space-y-4"
                                 *ngIf="messages && messages.length <= 0">
                                <i class="fa-solid fa-message fa-4x mx-auto text-gray-300"></i>
                                <p class="font-medium text-lg text-gray-400">Aun no hay mensajes para el
                                    contribuyente</p>
                            </div>

                            <ol class="relative border-l border-gray-200 dark:border-gray-700" *ngIf="messages">
                                <li class="mb-3 ml-4" *ngFor="let record of messages">
                                    <div
                                        class="absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white"></div>
                                    <time
                                        class="mb-1 text-xs font-normal leading-none text-gray-400">{{ record.fecha_alta | date: 'medium':'UTC' }}</time>
                                    <p class="mb-4 text-md font-normal text-gray-500">{{ record.mensaje }}</p>
                                </li>
                            </ol>

                            <!--<a (click)="seeDocument()" class="text-sm text-blue-500 underline hover:cursor-pointer"
                               *ngIf="selectedFile">{{ selectedFile.name }}</a>-->
                            <!--<p class="text-xs text-gray-400" *ngIf="!selectedFile">Tamaño de archivos maximo: 2MB</p>-->

                            <!--<form [formGroup]="messageForm" (ngSubmit)="createMessage(selectedFile)">
                                <mat-form-field appearance="outline" class="w-full">
                                    <mat-label>Mensaje para el contribuyente</mat-label>
                                    <textarea matInput formControlName="mensaje"></textarea>
                                </mat-form-field>

                                <div class="flex justify-between">
                                    <button type="submit" mat-flat-button color="primary" class="rounded-md">
                                        Enviar mensaje
                                    </button>
                                    &lt;!&ndash;<input type="file" class="hidden" #file (change)="getFile($event)" accept="application/pdf">
                                    <button type="button" (click)="file.click()" mat-stroked-button color="primary" class="rounded-md">
                                        Adjuntar documento
                                    </button>&ndash;&gt;
                                </div>
                            </form>-->
                        </div>
                    </div>
                </mat-tab>
                <mat-tab>
                    <ng-template mat-tab-label>
                        <i class="fa-solid fa-clock-rotate-left"></i>&nbsp;Historial de Cambios
                    </ng-template>

                    <div class="overflow-hidden bg-white mt-10 rounded-2xl border">
                        <div class="px-4 py-5 sm:px-6">
                            <div class="mb-5">
                                <h3 class="text-lg font-medium leading-6 text-gray-900">Historial de cambios</h3>
                                <p class="mt-1 max-w-2xl text-sm text-gray-500">Cambios durante el proceso del trámite
                                    de la solicitud</p>
                            </div>
                            <ol class="relative border-l border-gray-200 dark:border-gray-700">
                                <li class="mb-3 ml-4" *ngFor="let history of records">
                                    <div
                                        class="absolute w-3 h-3 bg-gray-200 rounded-full mt-1.5 -left-1.5 border border-white"></div>
                                    <time
                                        class="mb-1 text-xs font-normal leading-none text-gray-400">{{ history.fecha_alta | date: 'medium':'UTC' }}</time>
                                    <p class="mb-4 text-md font-normal text-gray-500">{{ history.comentario }}</p>
                                </li>
                            </ol>
                        </div>
                    </div>
                </mat-tab>
            </mat-tab-group>
        </div>
    </div>
</div>
